import os
import shutil

def move_unmatched_files(dir1, output_dir, unmatched_files):
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    moved_files = 0
    not_found_files = []

    for file_name in unmatched_files:
        full_name = file_name + '.dwg'  # Assuming all files in dir1 have .dwg extension
        src_path = os.path.join(dir1, full_name)
        dst_path = os.path.join(output_dir, full_name)

        if os.path.exists(src_path):
            shutil.move(src_path, dst_path)
            moved_files += 1
            print(f"Moved: {full_name}")
        else:
            not_found_files.append(full_name)

    print(f"\nSummary:")
    print(f"Total files to move: {len(unmatched_files)}")
    print(f"Files successfully moved: {moved_files}")
    if not_found_files:
        print(f"Files not found in dir1: {len(not_found_files)}")
        for file in not_found_files:
            print(f"  - {file}")

# Example usage
dir1 = r"Modified_12k_NEW\12k_DWG_NEW"  # dwg
output_dir = r"Modified_12k_NEW\Unmatched_Files"

unmatched_files = ['EHS010_SHT1', 'FD97-1007-06_SHT1', 'ET9000-0001-08_SHT1', 'D-1422X12_SHT1', 'EHW501_SHT1', 'EHW001_SHT2', 'EHW001_SHT1', 'FF1852H3-0612_SHT1', 'D-1161X10_SHT1', 'EHK029_SHT1', 'FF2271H3-1212_SHT1_CHN', 'FF2144H3-0808_SHT1', 'D-1422X2_SHT1', 'EHK015_SHT1', 'EHW150_SHT1', 'FF2001H3-0806_SHT1', 'FC170_SHT1', 'FC273B_SHT2', 'FF2151H3-1016_SHT1', 'FD31-1002_SHT1', 'FF2035H3-0606_SHT1', 'ET9000-0002_SHT1', 'EHP500_SHT2', 'FF2271H3-2020_SHT1', 'FF2001H3-1212_SHT1', 'EHP150_SHT1', 'FF2271H3-1212_SHT1', 'ET9000-0005_SHT2', 'FD96-1005_SHT1', 'D-1422X6_SHT1', 'EHA501_SHT1', 'FD12-1001-04-04_SHT1', 'FF2031H3-0402_SHT1', 'ET9000-0001_SHT1', 'FF2031H3-0408_SHT1', 'FD97-1016-08_SHT1', 'FB2107-01_SHT1', 'EHP519_SHT1', 'FD12-1000_SHT1', 'EHS001_SHT2', 'FD97-1019-02_SHT1', 'ET9000-0007_SHT1', 'D-1422X20_SHT1', 'FF2031H3-0608_SHT1', 'EHP522_SHT2', 'EHC036_SHT1', 'FF2033H3-0404_SHT1', 'ET5040-001-440KT_SHT1', 'FF1851H3-0606_SHT1', 'FF2271H3-1616_SHT1_CHN', 'FD96-1001_SHT1', 'ET9000-0002_SHT2', 'EHP002_SHT1', 'EHW030_SHT1', 'FD97-1007-04_SHT1', 'FF2035H3-1616_SHT1', 'D-1475X21_SHT1', 'EHP522_SHT1', 'EHW500_SHT1', 'FF2528H3-1010_SHT1', 'EHT200_SHT1', 'FD97-1016-04_SHT1', 'FF2031H3-0602_SHT1', 'EHG006_SHT1', 'D-1422X16_SHT1', 'FF2001H3-1616_SHT1', 'FC910_SHT1', 'FF2033H3-0808_SHT1', 'D-1475X10_SHT1', 'FF2035H3-1212_SHT1', 'D-1161X4_SHT1', 'FF1851H3-0404_SHT1', 'EHW029_SHT1', 'FF2031H3-0804_SHT1', 'FF1854H3-1616_SHT1', 'FF2001H3-2020_SHT1', 'ET5050-001-440KT_SHT1', 'D-1422X24_SHT1', 'D-1474X8_SHT1', 'D-1474X25_SHT1', 'D1600_SHT1', 'EHW028_SHT1', 'FD97-1019-06_SHT1', 'ET9000-0009_SHT1', 'ET9000-0007_SHT2', 'FF1854H3-0608_SHT1', 'EHW520_SHT1', 'EHP009_SHT1', 'D-1474X10_SHT1', 'D-1422X32_SHT1', 'D-1505X8_SHT1', 'EHS001_EL_SHT1', 'FF2151H3-0810_SHT1', 'EHP001_SHT2', 'EHW019_SHT1', 'FF2151H3-0612_SHT1', 'EHK022_SHT1', 'FF1898H3-0808_SHT1', 'FD97-1019-08_SHT1', 'FF2033H3-0606_SHT1', 'FBM3415_SHT1', 'EHW021_SHT1', 'FF1854H3-1212_SHT1', 'EHP521_SHT2', 'FF2035H3-0604_SHT1', 'EHA500_EL_SHT1', 'EHP520_SHT1', 'FF2501H3-1216_SHT1', 'FF2151H3-0412_SHT1', 'EHP529_SHT1', 'FF2035H3-1208_SHT1', 'EHW036_SHT1', 'FD96-1004_SHT1', 'D-1474X28_SHT1', 'EHS002_SHT1', 'EHP001_SHT1', 'FF2035H3-0808_SHT1', 'D-1505X10_SHT1', 'FD97-1007-08_SHT1', 'FF2271H3-0606_SHT1', 'D-1474X14_SHT1', 'FD97-1019-04_SHT1', 'EHP521_SHT1', 'ET9000-0003_SHT1', 'D-1474X22_SHT1', 'FD97-1016-06_SHT1', 'EHP007_SHT1', 'ET9000-0004_SHT1', 'EHT301_SHT1', 'D-1475X33_SHT1', 'FF2031H3-0812_SHT1', 'FF2035H3-0404_SHT1', 'FF2482H3-1212_SHT1_CHN', 'FF1858H3-1616_SHT1', 'FF1858H3-1216_SHT1', 'FC8153-S_SHT1', 'FF2001H3-0606_SHT1', 'EHW507_SHT1', 'FF2035H3-2424_SHT1', 'D-1422X8_SHT1', 'FF1854H3-1010_SHT1', 'FF2271H3-1616_SHT1', 'D-1475X27_SHT1', 'D-1422X4_SHT1', 'FD96-1009_SHT1', 'EHP541_SHT1', 'ET9000-0006_SHT2', 'FD97-1016-02_SHT1', 'ET9000-0006_SHT1', 'FF2035H3-2020_SHT1', 'FF2033H3-1212_SHT1', 'EHW022_SHT1', 'D-1505X12_SHT1', 'FD97-1007-02_SHT1', 'FD31-1005_SHT1', 'D-1474X30_SHT1', 'FF2218H3-1206_SHT1', 'FF2482H3-0808_SHT1_CHN']

move_unmatched_files(dir1, output_dir, unmatched_files)